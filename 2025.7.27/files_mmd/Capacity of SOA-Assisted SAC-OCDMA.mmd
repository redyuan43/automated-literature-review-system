

Manuscript received August 06, 2009; revised November 13, 2009; accepted November 15, 2009. First published January 12, 2010; current version published March 03, 2010.The authors are with the ECE Department, COPL, Universite Laval, Quebec, QC, G1V OA6, Canada (e-mail: rusch@gel.ulaval.ca).Color versions of one or more of the figures in this letter are available online at [http://ieeexplore.ieee.org.Digital](http://ieeexplore.ieee.org.Digital) Object Identifier 10.1109/LPT.2009.2039868

## I Introduction

The performance of spectral amplitude coded optical code-division multiple access (SAC-OCDMA) systems is severely curtailed by the excess intensity noise of the incoherent thermal-like light source. To mitigate the intensity noise, various solutions have been proposed. In one approach, the optical bandwidth of the frequency bins of all codes are optimized to trade-off noise reduction (due to optical bandwidth enlargement) when using wide overlapping optical bins against enhanced beat noise due to bin overlapping [1]. Another approach is to use intensity noise suppression offered by saturated semiconductor optical amplifiers (SOAs). SOA-based noise suppression has proven useful in spectrum-sliced wavelength-division-multiplexed (SS-WDM) systems [2, 3]. SOA-based noise suppression in SAC-OCDMA has been validated experimentally; however, the solution is costly with one SOA per occupied frequency bin per user [4]. A scheme with one SOA per user exploits the optimally designed code profiles in [1]. A reduced balanced receiver (RBR) is used for SOA-assisted SAC-OCDMA, replacing the standard conventional balanced receiver (CBR) [5]. The RBR was shown to be more robust than the CBR to noise-cleaning degradation due to post-SOA optical filtering [6]. The approach adopted in [5] was purely experimental; due to the system complexity, the experiments were limited to three active users in a seven-user system. The noise mitigation steadily degraded as users were added to the system, and no conclusion could be drawn regarding the ultimate capacity of this system.

We investigate quantitatively via simulation the extent to which one SOA per user can mitigate intensity noise in an SAC-OCDMA system in terms of bit-error rate (BER). Simulations in [4] are limited to relative intensity noise (RIN) which gives good indication of trends, but is a poor predictor of BER [3]. Several factors contribute to the difficulty of this simulation: the numerically complex SOA model to capture noise cleaning, multiple optical filters (OFs) for each user (transmitter and receiver), and the asynchronicity of the OCDMA signals.To this end, we employed the adaptive importance sampling simulation technique known as multicanonical Monte Carlo (MMC) [7, 8]. MMC was previously employed to study noise cleaning in SS-WDM systems [3, 9], reducing the computational burden by many orders of magnitude compared to simple Monte Carlo techniques.

We present MMC simulations of the SOA-assisted SAC-OCDMA systems, and validate our simulator against measurements in [5]. After establishing the reliability of our simulator, we examine systems with increasing numbers of users. We show that SOA-based noise mitigation efficiency rapidly degrades as the number of users increases, despite exploiting both optimally designed spectral codes and the RBR. Our simulator can be useful in studying other OCDMA systems, especially when optical nonlinearities result in non-Gaussian signal statistics. In Section II we describe the SAC-OCDMA receiver and transmitter, simulator and numerical results appear in Section III, and we conclude in Section IV.

## II System Description

Fig. 1 gives the \(N\)-user SOA-assisted SAC-OCDMA experimental setup of [5], including an RBR. The thermal-like radiation from an incoherent broadband source (BBS) is sliced by an OF with 7.2-nm 3-dB bandwidth and distributed to all users by a coupler. In simulations, the incoherent BBS, the 7.2-nm OF, and the erbium-doped fiber amplifier (EDFA) are modeled by a single complex Gaussian optical field whose spectrum is determined by the OF and whose power is the optical power at the EDFA output. At each transmitter, the incoherent slice is amplified by an EDFA to ensure saturation of the noise-cleaning SOA. The SAC-OCDMA code is applied (Enc\(\#i\) for user \(i\)) before entering the noise-cleaning SOA; data is imprinted via a Mach-Zehnder modulator (MZM). All signals are combined by a coupler, further amplified by a booster EDFA, and launched into 20 km of SMF fiber; a dispersion-compensating fiber (DCF) assures full dispersion compensation. The booster EDFA adds extra amplified spontaneous emission (ASE) noise to all the users, however, we verified by separate simulations that the system is intensity-noise limited and the EDFA can be assumed noiseless in the simulations. The SAC-OCDMA codes are balancedincomplete block design (BIBD) codes (Table I) of length 7, weight 3, and cross-correlation 1 [5].

As illustrated in Fig. 1, the RBR is different from the CBR in that the desired user encoder is removed from the upper arm, and the variable optical attenuator (VOA) is moved from the lower to the upper arm. The removal of the desired user encoder in the upper arm results in cancelation of the post-SOA filtering penalty in the upper arm. The VOA is adjusted such that the average detected optical powers in both arms of the RBR are equal whenever the desired user is absent. Moving the VOA from the lower to the upper branch of the balanced receiver results in \(\simeq\)1.4-dB power penalty in SAC-OCDMA performance compared to the CBR for the BIBD codes used; however, this small penalty is compensated by gain achieved by significantly reducing the post-SOA filtering penalty [5].

## III Numerical Model and Results

To numerically estimate the BER of the SOA-assisted SAC-OCDMA system in reasonable run-time, we used a parallel implementation of the MMC algorithm, similar to that for SS-WDM in [3] and [9]. The extension of the simulator to SAC-OCDMA must take into account the randomness in SAC-OCDMA systems stemming from four different origins: 1) the continuous-wave (CW) waveform of the light source utilized by each user--the optical field is a sample function of a complex Gaussian stochastic random process where the power spectral density of it is set by the specific spectral code assigned to that user; 2) the bit pattern transmitted by each user; 3) the relative temporal delays between the desired user and all other active users; and 4) the electronic noise at the receiver side of the desired user [9].

Two MMC simulations estimate the conditional probability density functions (pdfs) of marks and spaces when the receiver noise is set to zero. Each conditional pdf is convolved with the Gaussian pdf of the receiver noise, and finally the BER is calculated by integrating the overlapping tails of the conditional pdfs of marks and spaces. Proper scaling of the horizontal axes of the two conditional pdfs yields the performance at a specific received power. Each MMC simulation consisted of six adaptation cycles. During each MMC cycle, \(k=20\,000\) time-domain simulations of the whole system were executed.

Fig. 2(a) shows three optimized spectral codes according to [1], realized by fiber Bragg gratings and used in the experiments reported in [5]. Fig. 2(b) illustrates one system realization during an MMC cycle, giving a snapshot of the temporal waveforms generated. We assume \(M=3\) bits of memory. The final bit of the desired user is set to one for marks (zero for spaces), while the preceding bits of the desired user, and all bits of the interferers, are random. The light source sample functions are synthesized by proposing vectors of independent identically distributed Gaussian random variables of zero mean and unit variance, and filtering them by the corresponding spectral codes. The bit patterns are proposed by Metropolis-Hastings modules called pattern number generators, as described in [3], [9], and [10]. To realistically estimate the OCDMA performance, the asynchronicity of users should be properly modeled. To do so, during each of \(k\) simulations within each MMC cycle, we generate an \((M{+}1)\)-bit waveform for the desired user, where the final bit is forced to be either always one or always zero, and \((M+2)\)-bit waveforms for all interferers. The reference timing is that of the desired user, and the temporal sample used to calculate the conditional pdf is taken at the end of the final bit of the desired user. The waveform of interferer \(\#i\) is temporally shifted with respect to the desired user waveform by a random time delay denoted by \(td_{i}\), which is uniformly distributed over 0, and \(N_{s}-1\), where \(N_{s}\) is the number of time samples within a bit duration. If the bit-rate is denoted by \(R_{b}\), the bit duration is \(T_{b}=1/R_{b}\), and \(N_{s}\triangleq T_{b}/\Delta t\), where \(\Delta t\) is the simulation time step. The multiple access time delays are proposed by a Metropolis-Hastings module called the interferer delay generator [9]. The SOA was modeled as described in [9].

Fig. 1: \(N\)-user SOA-assisted SAC-OCDMA setup with RBR after [5]. Enc: SAC-OCDMA encoder. MZM: Machâ€“Zehnder modulator. EF: electrical filter. The polarization beam splitters and polarization controllers at the SOA input and MZM input, as well as optical isolators, are not shown for simplicity.

Fig. 2: (a) Spectral codes of the desired user and two interferers, (b) Snapshot of a three-user simulation of the system.

The key SOA parameters are saturation power, carrier life-time, linewidth enhancement factor, small-signal gain, and distributed loss. The parameters we used in our simulations are exactly the values obtained by careful characterization of the same components used by our colleagues who authored [5]. The electrical filter was a fourth-order Bessel-Thompson with 0.75\(R_{b}\) 3-dB bandwidth.

Fig. 3 shows the MMC estimated BER versus received power for two, three, five, and seven active users at \(R_{b}=2.5\) Gb/s. Experimental BER floors reported in [5] are indicated by the arrows to the right of the figure. The solid curves show the BERs of the SAC-OCDMA, while the dashed curves show those of the SOA-assisted SAC-OCDMA. For two and three users, simulated BER floors for SAC-OCDMA are 5.0E-10 and 1.1E-6, respectively; the corresponding measured values are 5.4E-10 and 5.2E-6. The simulated BER floors for two and three users of SOA-assisted SAC-OCDMA are 2.8E-16. and 5.7E-7; the corresponding three-user measured value is 2.8E-7. The SOA-assisted two-user BER floor was unmeasurable.

The good match between simulation and measurement, in spite of lack of full characterization of the experimental setup, attests to the reliability of the simulator. From Fig. 3, we see diminishing returns in BER improvement as the number of active users grows. The BER floor improvement due to SOA-based noise suppression is four orders of magnitude for two users, less than two orders of magnitude for three users, and less than one order of magnitude for five and seven users.

Comparing SOA-based intensity noise suppression efficiency in SAC-OCDMA and SS-WDM, we observe that noise-cleaning efficiency is not degraded as the number of active users is increased in SS-WDM, whereas it rapidly becomes ineffective in SAC-OCDMA. Note that in SAC-OCDMA, there is always a strong filtering effect in the lower arm of the receiver balanced detector; as the number of users increases, so does the number of noisy interferers that are added to the decision variable through the lower arm. Contrary to this, in SS-WDM, the performance is only slightly degraded due to the crosstalk induced by two adjacent channels. Further increases in the number of SS-WDM users does not impact BER [6].

Fig. 4 represents the MMC estimated two- and three-user BER curves of SOA-assisted SS-WDM, together with the \(Q\)-factor approximations of the BERs directly calculated using the estimated conditional pdfs by MMC. The observation in [5] that the true BER is underestimated when using \(Q\)-factor approximation is confirmed by simulation. This indicates that signal statistics is highly non-Gaussian, and justifies the need of numerical tools to study such systems.

## IV Conclusion

An MMC simulator for modeling SOA-assisted SAC-OCDMA systems was developed, and was used to estimate the BERs of SAC-OCDMA when SOA-based noise suppression scheme is optionally employed in the transmitter side. The BER improvement versus number of active users were traced, and it was shown that, contrary to SOA-assisted SS-WDM, the noise mitigation offered by the SOA-based noise suppression scheme rapidly degrades as the number of active users passes three. The inadequacy of the Gaussian assumption for signal statistics was demonstrated by comparing BER predictions from MMC with those obtained from \(Q\)-factor approximation. The numerical results were validated against the previously published experimental results.

